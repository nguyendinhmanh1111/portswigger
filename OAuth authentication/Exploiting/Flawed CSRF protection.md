# Flawed CSRF protection

User's session sẽ được chuyển thành mã hash Giá trị này sau đó được chuyển qua lại giữa ứng dụng khách và dịch vụ OAuth dưới dạng mã thông báo CSRF cho client-app

Tấn công Cross-Site Request Forgery là kiểu tấn công mà kẻ tấn công lừa người sử dụng truy cập tới một trang web độc hại (hacker có thể kiểm soát), thông qua trang đó kẻ tấn công có thể tấn công một trang khác (Cross-site) mà người dùng đã xác minh (thông thường là đã có cookie). Để chống lại kiểu tấn công này, thông thường là các request quan trọng sẽ có thêm một csrf token để ngăn các tấn công cross site.

## Lab: Forced OAuth profile linking

![image](https://user-images.githubusercontent.com/76999751/132112272-cf0f031c-81ac-4f12-9217-38290f0dc52f.png)

Trong bài này, trang web hỗ trợ 2 cơ chế xác minh đăng nhập là basic auth với username/password và đăng nhập với OAuth. Tài khoản OAuth có thể được kết nối tới một tài khoản thông thường. Lợi dụng tính năng này chúng ta sẽ tấn công để có thể kết nối tài khoản OAuth của mình với tài khoản đăng nhập của admin.

![image](https://user-images.githubusercontent.com/76999751/132112329-dc541bbb-257a-4b56-aeab-c85e4616e494.png)

Ở đây, có một tính năng để liên kết tài khoản của người dùng với một tài khoản OAuth. Request gửi lên sẽ gửi authorization code của tài khoản Oauth lên để liên kết với tài khoản.
